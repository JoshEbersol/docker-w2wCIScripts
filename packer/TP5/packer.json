{
	"variables": {
	 	"image_name_prefix": "jenkins-tp5",
	 	"username": "jenkins",
		"password": "{{env `password`}}",
	 	"sn": "Microsoft Azure Sponsorship",
	 	"ps": "{{ env `HOME` }}/.azure/engine-team@docker.com.publishsettings",
	 	"sa": "tp5"
	},
	"builders": [
	 	{
	 	 	"type": "azure",
	 	 	"publish_settings_path": "{{user `ps`}}",
	 	 	"subscription_name": "{{user `sn`}}",
	 	 	"storage_account": "{{user `sa`}}",
	 	 	"storage_account_container": "images",
	 	 	"os_type": "Windows",
	 	 	"os_image_label": "azuretp5v2",
	 	 	"location": "Central US",
	 	 	"instance_size": "Standard_D2",
	 	 	"user_image_label": "{{ user `image_name_prefix` }}_{{ isotime \"2016.03.29_23.20.00.0000\" }}"
	 	}
	],
	"provisioners": [
	 	{
	 	 	"type": "azure-custom-script-extension",
	 	 	"inline": [
				"Write-Host INFO: Packer script provisioner starting...",
				"Write-Host INFO: Creating packer directory...",
				"mkdir c:\\packer -ErrorAction SilentlyContinue 2>&1 | Out-Null",
				"Write-Host INFO: Creating scripts directory...",
				"mkdir c:\\scripts -ErrorAction SilentlyContinue 2>&1 | Out-Null",
				"Write-Host INFO: Downloading ConfigureCIEnvironment.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureCIEnvironment.ps1\",\"c://packer//ConfigureCIEnvironment.ps1\")",
				"Write-Host INFO: Downloading InstallMostThings.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/InstallMostThings.ps1\",\"c://packer//InstallMostThings.ps1\")",
				"Write-Host INFO: Downloading authorized_keys...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/authorized_keys\",\"c://packer//authorized_keys\")",
				"Write-Host INFO: Downloading PostSysprep.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/PostSysprep.ps1\",\"c://packer//PostSysprep.ps1\")",
				"Write-Host INFO: Downloading ConfigureScheduledTasksAfterSysprep.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureScheduledTasksAfterSysprep.ps1\",\"c://packer//ConfigureScheduledTasksAfterSysprep.ps1\")",
				"Write-Host INFO: Downloading ConfigureSSH.sh...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureSSH.sh\",\"c://packer//ConfigureSSH.sh\")",
				"Write-Host INFO: Storing password temporarily...",
				"[System.IO.File]::WriteAllText('c:\\packer\\password.txt', '{{user `password`}}', (New-Object System.Text.UTF8Encoding($False)))",
				"Write-Host INFO: Invoking ConfigureCIEnvironment.ps1...",
				"c:\\packer\\ConfigureCIEnvironment.ps1",
				"Write-Host INFO: Invoking InstallMostThings.ps1...",
				"c:\\packer\\InstallMostThings.ps1",
				"#Write-Host INFO: Invoking ConfigureTempToD.ps1...",
				"#c:\\packer\\ConfigureTempToD.ps1",
				"Write-Host INFO: Invoking ConfigureScheduledTasksAfterSysprep.ps1...",
				"c:\\packer\\ConfigureScheduledTasksAfterSysprep.ps1",
				"Write-Host INFO: Packer provisioner complete"
			]
		}
	]
}