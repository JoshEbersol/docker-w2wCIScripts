{
	"variables": {
	 	"image_name_prefix": "jenkins-tp5",
	 	"username": "jenkins",
	 	"password": "{{env `password:`}}",
	 	"sn": "Microsoft Azure Sponsorship",
	 	"ps": "{{ env `HOME` }}/.azure/engine-team@docker.com.publishsettings",
	 	"sa": "tp5"
	},
	"builders": [
	 	{
	 	 	"type": "azure",
	 	 	"publish_settings_path": "{{user `ps`}}",
	 	 	"subscription_name": "{{user `sn`}}",
	 	 	"storage_account": "{{user `sa`}}",
	 	 	"storage_account_container": "images",
	 	 	"os_type": "Windows",
	 	 	"os_image_label": "azuretp5v2",
	 	 	"location": "Central US",
	 	 	"instance_size": "Standard_D2",
	 	 	"user_image_label": "{{ user `image_name_prefix` }}_{{ isotime \"2016.03.29_23.20.00.0000\" }}"
	 	}
	],
	"provisioners": [
	 	{
	 	 	"type": "azure-custom-script-extension",
	 	 	"inline": [
				"Write-Host INFO: Packer script provisioner starting...",
				"Write-Host INFO: Creating packer directory...",
				"mkdir c:\\packer | Out-Null",
				"Write-Host INFO: Creating scripts directory...",
				"mkdir c:\\scripts | Out-Null",
				"Write-Host INFO: Storing password temporarily...",
				"$pwd = '{{user `password`}}'; $pwd | Out-File c:\\scripts\\SSHpassword.txt",
				"Write-Host INFO: Downloading ConfigureCIEnvironment.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureCIEnvironment.ps1\",\"c://packer//ConfigureCIEnvironment.ps1\")",
				"Write-Host INFO: Downloading SetupNSSM.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/SetupNSSM.ps1\",\"c://packer//SetupNSSM.ps1\")",
				"Write-Host INFO: Downloading InstallMostThings.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/InstallMostThings.ps1\",\"c://packer//InstallMostThings.ps1\")",
				"Write-Host INFO: Downloading ConfigureTempToD.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureTempToD.ps1\",\"c://packer//ConfigureTempToD.ps1\")",
				"Write-Host INFO: Downloading authorized_keys...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/authorized_keys\",\"c://packer//authorized_keys\")",
				"Write-Host INFO: Downloading SetupSSH.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/SetupSSH.ps1\",\"c://scripts//SetupSSH.ps1\")",
				"Write-Host INFO: Downloading ActivateVM.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ActivateVM.ps1\",\"c://scripts//ActivateVM.ps1\")",
				"Write-Host INFO: Downloading ConfigureScheduledTasksAfterSysprep.ps1...",
				"$wc=New-Object net.webclient;$wc.Downloadfile(\"https://raw.githubusercontent.com/jhowardmsft/docker-w2wCIScripts/master/packer/TP5/ConfigureScheduledTasksAfterSysprep.ps1\",\"c://scripts//ConfigureScheduledTasksAfterSysprep.ps1\")",
				"Write-Host INFO: Invoking ConfigureCIEnvironment.ps1...",
				"c:\\packer\\ConfigureCIEnvironment.ps1",
				"Write-Host INFO: Invoking SetupNSSM.ps1...",
				"c:\\packer\\SetupNSSM.ps1",
				"Write-Host INFO: Invoking InstallMostThings.ps1...",
				"c:\\packer\\InstallMostThings.ps1",
				"Write-Host INFO: Invoking ConfigureTempToD.ps1...",
				"c:\\packer\\ConfigureTempToD.ps1",
				"Write-Host INFO: Invoking ConfigureScheduledTasksAfterSysprep.ps1...",
				"c:\\scripts\\ConfigureScheduledTasksAfterSysprep.ps1",
				"Write-Host INFO: Packer provisioner complete"
			]
		}
	]
}